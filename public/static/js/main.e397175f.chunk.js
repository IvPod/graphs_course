(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{67:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r,a,c,i=n(2),s=n.n(i),o=n(41),l=n.n(o),d=(n(67),n(89)),u=n(91),b=n(88),j=n(8),h=n(7),f=n.n(h),O=(n(68),n(76)),p=n(82),g=n(94),v=n(83),x=n(81),m=n(3),w=function(){var e=Object(O.a)(),t=Object(i.useRef)(null);Object(i.useEffect)((function(){f.a.DomEvent.disableClickPropagation(t.current)}),[]);return Object(m.jsx)("div",{className:"leaflet-bottom leaflet-left",ref:t,children:Object(m.jsx)("div",{className:"leaflet-control",children:Object(m.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){e.locate().on("locationfound",(function(t){e.setView(t.latlng,e.getZoom())})).on("locationerror",console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"))},"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"\u041c\u043e\u044f \u043f\u043e\u0437\u0438\u0446\u0438\u044f",children:Object(m.jsx)("i",{className:"bi bi-geo-alt"})})})})},y=n(33),N=n(90),E=n(59),k=Object(N.a)(r||(r=Object(y.a)(["\n  query GetWeather($lat: Float, $lon: Float) {\n    weather(lat: $lat, lon: $lon) {\n      name\n      description\n      temp\n      humidity\n      pressure\n      windSpeed\n    }\n  }\n"]))),M=function(e){var t=e.location,n=Object(E.a)(k,{variables:{lat:t.lat,lon:t.lng}}),r=n.loading,a=n.error,c=n.data;return a?Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"})}):r?Object(m.jsx)("div",{className:"spinner-border",role:"status",children:Object(m.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):Object(m.jsxs)("div",{className:"row align-items-start",children:[Object(m.jsx)("div",{className:"col",children:Object(m.jsx)("table",{className:"table table-info table-sm",children:Object(m.jsxs)("tbody",{children:[Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u0410\u0434\u0440\u0435\u0441"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.name:""})]}),Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u041f\u043e\u0433\u043e\u0434\u0430"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.description:""})]}),Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.temp:""})]})]})})}),Object(m.jsx)("div",{className:"col",children:Object(m.jsx)("table",{className:"table table-info table-sm",children:Object(m.jsxs)("tbody",{children:[Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.pressure:""})]}),Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.humidity:""})]}),Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{scope:"row",children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430"}),Object(m.jsx)("td",{children:(null===c||void 0===c?void 0:c.weather)?c.weather.windSpeed:""})]})]})})})]})},B=n(78),P=n(77),S=function(e,t){document.getElementById("alertPlaceholder").innerHTML='<div class="alert alert-'+t+' alert-dismissible" role="alert">'+e+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>'},$=function(){var e=Object(O.a)(),t=Object(i.useRef)(null);Object(i.useEffect)((function(){f.a.DomEvent.disableClickPropagation(t.current)}),[]);var n=Object(N.a)(a||(a=Object(y.a)(["\n    query Roads($bb: String!) {\n      roads(bb: $bb) {\n        coordinates\n      }\n    }\n  "]))),r=Object(P.a)(n),c=Object(j.a)(r,2),s=c[0],o=c[1],l=o.loading,d=o.error,u=o.data,b=Object(m.jsx)("div",{className:"leaflet-bottom leaflet-right",ref:t,children:Object(m.jsx)("div",{className:"leaflet-control",children:Object(m.jsx)("button",{type:"button",className:"btn btn-primary",disabled:l,onClick:function(){return s({variables:{bb:e.getBounds().toBBoxString()}})},"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"\u0414\u043e\u0440\u043e\u0433\u0438",children:l?Object(m.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status"}):Object(m.jsx)("i",{className:"bi bi-signpost-split"})})})});if(d)return S("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c!","warning"),b;if(u){var h,p=[];return null===u||void 0===u||null===(h=u.roads)||void 0===h||h.forEach((function(e){return p.push(e.coordinates)})),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(B.a,{pathOptions:{color:"lightskyblue"},positions:p}),b]})}return b},C=n(11),F=n(92),I=n(79),q=n(80),D=n(93),R=function(e,t){for(var n=e.keys(),r=n.next();t.includes(r.value);)r=n.next();return r.value},z=function(e,t,n){var r=new Map;e.get(t).edges.forEach((function(e){return r.set(e.node,e.weight)}));var a={endNode:null};e.get(t).edges.forEach((function(e){return a[e.node]=t}));for(var c=[],i=R(r,c),s=function(){var n=r.get(i);e.get(i).edges.forEach((function(e){if(e.node!==t){var c=n+e.weight;(!r.get(e.node)||r.get(e.node)>c)&&(r.set(e.node,c),a[e.node]=i)}})),c.push(i),i=R(r,c)};i;)s();for(var o=[n],l=a[n];l;)o.push(l),l=a[l];o.reverse();var d=[];o.map((function(t){return d.push(e.get(t).coordinates)}));var u=[];return c.map((function(t){return u.push(e.get(t).coordinates)})),{distance:r.get(n),path:o,line:d,visitedPoints:u}},G=function(e,t){var n=null;return e.forEach((function(r,a){(null===n||r<e.get(n))&&!t.includes(a)&&(n=a)})),n},J=function(e,t,n){var r=new Map;e.get(t).edges.forEach((function(e){return r.set(e.node,e.weight)}));var a={endNode:null};e.get(t).edges.forEach((function(e){return a[e.node]=t}));for(var c=[],i=G(r,c),s=function(){var n=r.get(i);e.get(i).edges.forEach((function(e){if(e.node!==t){var c=n+e.weight;(!r.get(e.node)||r.get(e.node)>c)&&(r.set(e.node,c),a[e.node]=i)}})),c.push(i),i=G(r,c)};i&&i!==n;)s();for(var o=[n],l=a[n];l;)o.push(l),l=a[l];o.reverse();var d=[];o.map((function(t){return d.push(e.get(t).coordinates)}));var u=[];return c.map((function(t){return u.push(e.get(t).coordinates)})),{distance:r.get(n),path:o,line:d,visitedPoints:u}},L=n(9),T=function(e){return e*Math.PI/180},W=function(e,t){var n=T(e[0]),r=T(e[1]),a=T(t[0]),c=T(t[1]),i=Math.sin((a-n)/2),s=Math.sin((c-r)/2);return 12742*Math.asin(Math.sqrt(i*i+Math.cos(n)*Math.cos(a)*s*s))*1e3},Z=function(e,t,n){var r=null;return e.forEach((function(a,c){(null===r||a+n.get(c).heuristic<e.get(r)+n.get(r).heuristic)&&!t.includes(c)&&(r=c)})),r},A=function(e,t,n){var r=new Map,a=e.get(n).coordinates;e.forEach((function(e,t,n){n.set(t,Object(L.a)(Object(L.a)({},e),{},{heuristic:W(e.coordinates,a)}))})),e.get(t).edges.forEach((function(e){return r.set(e.node,e.weight)}));var c={endNode:null};e.get(t).edges.forEach((function(e){return c[e.node]=t}));for(var i=[],s=Z(r,i,e),o=function(){var n=r.get(s);e.get(s).edges.forEach((function(e){if(e.node!==t){var a=n+e.weight;(!r.get(e.node)||r.get(e.node)>a)&&(r.set(e.node,a),c[e.node]=s)}})),i.push(s),s=Z(r,i,e)};s&&s!==n;)o();for(var l=[n],d=c[n];d;)l.push(d),d=c[d];l.reverse();var u=[];l.map((function(t){return u.push(e.get(t).coordinates)}));var b=[];return i.map((function(t){return b.push(e.get(t).coordinates)})),{distance:r.get(n),path:l,line:u,visitedPoints:b}},H=function(e,t,n){var r=[0,99999],a=[0,99999];return e.forEach((function(e,c){r[1]>W(e.coordinates,t)&&(r[1]=W(e.coordinates,t),r[0]=c),a[1]>W(e.coordinates,n)&&(a[1]=W(e.coordinates,n),a[0]=c)})),[r[0],a[0]]},V=["id"],K=function(e){var t=e.start,n=e.finish,r=Object(O.a)(),a=Object(i.useRef)(null);Object(i.useEffect)((function(){f.a.DomEvent.disableClickPropagation(a.current)}),[]);var s=Object(N.a)(c||(c=Object(y.a)(["\n    query Treks(\n      $bb: String!\n      $start: [Float]\n      $finish: [Float]\n    ) {\n      graphInBox(bb: $bb, start: $start, finish: $finish) {\n        id\n        coordinates\n        heuristic\n        edges {\n          node\n          weight\n        }\n      }\n    }\n  "]))),o=Object(P.a)(s),l=Object(j.a)(o,2),d=l[0],u=l[1],b=u.loading,h=u.error,p=u.data,g=function(e,t,n){return Object(m.jsx)(I.a.Overlay,{name:"\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c ".concat(t),children:Object(m.jsxs)(q.a,{children:[Object(m.jsxs)(x.a,{children:[" ","\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c ".concat(t)," ",Object(m.jsx)("br",{})," ",e.distance&&"\u0414\u043b\u0438\u043d\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430 = ".concat(e.distance.toFixed(1)," (\u043c)")," ",Object(m.jsx)("br",{})," ","\u041f\u0440\u043e\u0439\u0434\u0435\u043d\u043e \u0443\u0437\u043b\u043e\u0432: ".concat(e.visitedPoints.length)," "]}),Object(m.jsx)(B.a,{pathOptions:{color:"lightskyblue"},positions:e.line}),e.visitedPoints.map((function(e){return Object(m.jsx)(D.a,{center:e,pathOptions:{fillColor:n,fillOpacity:.8},stroke:!1,radius:10},Object(F.a)())}))]})})},v=Object(m.jsx)("div",{className:"leaflet-top leaflet-right",ref:a,children:Object(m.jsx)("div",{className:"leaflet-control",children:Object(m.jsx)("button",{type:"button",className:"btn btn-primary",disabled:b,onClick:function(){return d({variables:{bb:r.getBounds().toBBoxString(),start:[t.lat,t.lng],finish:[n.lat,n.lng]}})},"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"\u041c\u0430\u0440\u0448\u0440\u0443\u0442\u044b",children:b?Object(m.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status"}):Object(m.jsx)("i",{className:"bi bi-compass"})})})});if(h)return S("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f, \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e, \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c!","warning"),v;if(p){var w=new Map;p.graphInBox.forEach((function(e){var t=e.id,n=Object(C.a)(e,V);return w.set(t,n)}));var E=H(w,[t.lat,t.lng],[n.lat,n.lng]),k=z(w,E[0],E[1]),M=J(w,E[0],E[1]),$=A(w,E[0],E[1]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(D.a,{center:w.get(E[0]).coordinates,pathOptions:{fillColor:"blue",fillOpacity:.8},stroke:!1,radius:20}),Object(m.jsx)(D.a,{center:w.get(E[1]).coordinates,pathOptions:{fillColor:"blue",fillOpacity:.8},stroke:!1,radius:20}),Object(m.jsxs)(I.a,{position:"topleft",children:[k&&g(k,"BFS","#f96"),M&&g(M,"Dijikstra","#0cc"),$&&g($,"A*","#e75480")]})]})}return v},Q=function(){f.a.Icon.Default.imagePath="/images/";var e=Object(i.useState)({lat:59.88122,lng:29.90677}),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(null),c=Object(j.a)(a,2),s=c[0],o=c[1],l=Object(i.useState)(null),d=Object(j.a)(l,2),u=d[0],b=d[1],h=function(){var e=Object(O.b)({moveend:function(){r(e.getCenter()),s&&!e.getBounds().contains(s)&&o(null),u&&!e.getBounds().contains(u)&&b(null)},click:function(e){u?(o(u),b(e.latlng)):s?b(e.latlng):o(e.latlng)}});return null};return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsxs)("div",{className:"row justify-content-between mt-3",children:[Object(m.jsx)("div",{className:"col-auto",children:Object(m.jsx)("h1",{children:" Graphs 101"})}),Object(m.jsx)("div",{className:"col-auto",children:Object(m.jsx)(M,{location:n})})]}),Object(m.jsxs)(p.a,{center:n,zoom:15,scrollWheelZoom:!1,children:[Object(m.jsx)(g.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}),s&&Object(m.jsx)(v.a,{position:s,children:Object(m.jsx)(x.a,{children:"Start"})}),u&&Object(m.jsx)(v.a,{position:u,children:Object(m.jsx)(x.a,{children:"Finish"})}),Object(m.jsx)(w,{}),Object(m.jsx)($,{}),s&&u?Object(m.jsx)(K,{start:s,finish:u}):null,Object(m.jsx)(h,{})]}),Object(m.jsx)("div",{id:"alertPlaceholder"})]})},U=new d.a({uri:"/graphql",cache:new u.a({typePolicies:{Node:{fields:{edges:{merge:!1}}}}})});l.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(b.a,{client:U,children:Object(m.jsx)(Q,{})})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.e397175f.chunk.js.map